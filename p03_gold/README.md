# Предсказание коэффициента восстановления золота из золотосодержащей руды
*Проект завершен в декабре 2022*

*Этот проект является сборным по итогам модуля "Введение в машинное обучение". Для лучшего понимания незнакомой доменной области был создан "справочник" по параметрам технологического процесса – датафрейм с названиями, типами и расшифровкой параметров процесса, а также этапами, для которых они характерны и примерами значений. Также была разработана и реализована функция заполнения выбросов и пропущенных значений в данных, вызванных несистемными сбоями датчиков. В ходе проекта было построено 3 модели машинного обучения с автоматическим подбором гиперпараметров и оценкой качества на кросс-валидации. Лучшая модель также прошла проверку на адекватность*

## Описание
Необходимо подготовить прототип модели машинного обучения, предсказывающей эффективность обогащения руды – т.е. коэффициент восстановления золота из золотосодержащей руды. Заказчик – компания, разрабатывающая решения для эффективной работы промышленных предприятий. Данная модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками

В нашем распоряжении 3 файла – данные с параметрами добычи и очистки – обучающая выборка, тестовая выборка и исходные данные. Данные индексируются датой и временем получения информации. Соседние по времени параметры часто похожи. Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков. Исходный датасет содержит обучающую и тестовую выборки со всеми признаками

## Цели
- Проверить правильность расчёта эффективности обогащения – вычислить MAE между расчётами и фактическими значениями признака
- Изучить, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате, какие особенности имеют распределения
- Сравнить распределения размеров гранул исходного сырья на обучающей и тестовой выборках
- Исследовать суммарную концентрацию металлов на разных стадиях: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате
- Обучить разные модели и оценить их качество кросс-валидацией. Выбрать лучшую модель и проверить её на тестовой выборке

## Выводы
- Проверена корректность расчёта эффективности обогащения
- Исследовали поведение концентрации металлов на различных этапах очистки: концентрация золота (Au) увеличивается с каждым этапом, остальные сопутствующие вещества ведут себя по-разному – концентрация свинца медленно повышается, а серебра (Ag) и (Sol) – снижается
- Значительных различий в распределениях размера гранул сырья на обучающей и тестовой выборках не выявлено
- Исследовали суммарную концентрацию всех веществ на различных этапах очистки. Каких-либо аномалий не выявлено, изменение данного показателя хорошо объясняется изменениями концентрации отдельных веществ
- Применили для предсказания целевого признака 3 модели машинного обучения: "Линейная регрессия", "Дерево решений" и "Случайный лес"
- При помощи кросс-валидации и функции расчёта целевой метрики провели сравнение и определили лучшую модель

Лучшей моделью был выбрана модель "Случайный лес". Модель прошла проверку на адекватность и была проверена на тестовой выборке. Были достигнуты значения метрики итогового sMAPE = 7.3539

## Стек
python, pandas, numpy, matplotlib, seaborn, sklearn
